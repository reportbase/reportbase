<html>
<head>
<link href="https://cdn.jsdelivr.net/npm/gridjs/dist/theme/mermaid.min.css" rel="stylesheet" />
</head>
	
<body>
<script src="https://accounts.google.com/gsi/client" async defer></script>
<script src="https://cdn.jsdelivr.net/npm/gridjs/dist/gridjs.umd.js"></script>
	
<form id=uploadformdata>  
<input type="file" id="file" multiple="multiple">
<button type="submit">Upload</button>
</form>
<br>
	
<form id=galleryform> 	
<label for="email">Email:</label><br>
<input type="text" id="name" name="name">
<button type="submit">Show</button>
</form>
<p>

	
<div id="wrapper"></div>
<script>
function gridshow()
{
    	var email = document.getElementById("name").value;
	if (!email)
		return;
	fetch(`https://bucket.reportbase5836.workers.dev/${email}`)
	.then(function(response) 
	      {
		      if (response.ok)
			return response.json()
			throw Error(response.statusText);
	      })
	.then(function(results)
	      {
		new gridjs.Grid({
		  columns: ["Name", "Email", "Phone Number"],
		pagination: true,
		search: true,
		sort: true,
		resizable: true,	
		  data: [
		    ["John", "john@example.com", "(353) 01 222 3333"],
		    ["Mark", "mark@gmail.com", "(01) 22 888 4444"],
		    ["Eoin", "eoin@gmail.com", "0097 22 654 00033"],
		    ["Sarah", "sarahcdd@gmail.com", "+322 876 1233"],
		    ["Afshin", "afshin@mail.com", "(353) 22 87 8356"]
		  ]
		}).render(document.getElementById("wrapper"));
	      })
	.catch(error => console.log(error));
}
gridshow();
</script>
	
<script>

    const galleryform = document.getElementById('galleryform');
    galleryform.addEventListener('submit', async event => 
    {
	    event.preventDefault();
	    gridshow(); 
    })

    const uploadformdata = document.getElementById('uploadformdata');
    uploadformdata.addEventListener('submit', async event => 
    {
      event.preventDefault();
	var email = document.getElementById("name").value;
    if (!email)
	    return;
	    
	var files = document.getElementById('file').files;
	    for (var n = 0; n < files.length; ++n)
	    {
	      const file = files[n];
	      const form = new FormData();
	      form.append('file', file);
	      form.append('title', file.name.split('.')[0]);
	      form.append('email', email);

	      fetch(`https://bucket.reportbase5836.workers.dev/bucket1`,
	      {
		'method': 'POST',
		'body': form
	      })
 		.then(function(response) 
                      {
                              if (response.ok)
                                return response.text()
                                throw Error(response.statusText);
                      })
		.then(function(results)
		      {
			      console.log(results);
		      })
                .catch(error => console.log(error)); 
	    }
    });
</script>    

</body>
</html>
