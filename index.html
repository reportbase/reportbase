 <html>
<body>
<script src="https://accounts.google.com/gsi/client" async defer></script>

<form id=uploadformdata>  
<input type="file" id="file" multiple="multiple">
<button type="submit">Upload</button>
</form>
<br>
	
<form id=galleryform> 	
<label for="email">Email:</label><br>
<input type="text" id="name" name="name">
<button type="submit">Show</button>
</form>
<p>
	
<script>

    const galleryform = document.getElementById('galleryform');
    galleryform.addEventListener('submit', async event => 
    {
	    var email = document.getElementById("name").value;
      fetch(`https://bucket.reportbase5836.workers.dev/${email}`,
      {
	'method': 'USER'
      })
	.then(function(response) 
	      {
		      if (response.ok)
			return response.text()
			throw Error(response.statusText);
	      })
	.then(function(results)
	      {
		      console.log(results);
	      })
	.catch(error => console.log(error)); 
    })

    const uploadformdata = document.getElementById('uploadformdata');
    uploadformdata.addEventListener('submit', async event => 
    {
      event.preventDefault();
	var email = document.getElementById("name").value;
	    
	var files = document.getElementById('file').files;
	    for (var n = 0; n < files.length; ++n)
	    {
	      const file = files[n];
	      const form = new FormData();
	      form.append('file', file);
	      form.append('title', file.name.split('.')[0]);
	      form.append('email', email);

	      fetch(`https://bucket.reportbase5836.workers.dev/bucket1`,
	      {
		'method': 'POST',
		'body': form
	      })
 		.then(function(response) 
                      {
                              if (response.ok)
                                return response.text()
                                throw Error(response.statusText);
                      })
		.then(function(results)
		      {
			      console.log(results);
		      })
                .catch(error => console.log(error)); 
	    }
    });
</script>    

</body>
</html>
