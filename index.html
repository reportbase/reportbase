<html>
<body>
<script src="https://accounts.google.com/gsi/client" async defer></script>

<form id="uploadformdata">
<input type="file" id="file"> 
<button type="submit">Upload FormData</button>
</form>

<script>
        async function handleCredentialResponse(response) 
        {
          console.log("Encoded JWT ID token: " + response.credential);
                fetch(`https://reportbase.me/login?token=${response.credential}`)
                .then(function(response) 
                      {
                              if (response.ok)
                                return response.text()
                                throw Error(response.statusText);
                      })
                .then(function(json)
                      {
                              console.log(json)
                      })
                .catch(error => console.log(error));           
         }
        
        window.onload = function () 
        {
          google.accounts.id.initialize(
          {
            client_id: "676848032016-7rdfc1a1gse8olfh399kfqtahqvu5ci5.apps.googleusercontent.com",
            callback: handleCredentialResponse
          });
                
          google.accounts.id.renderButton(
            document.getElementById("buttonDiv"),
            { theme: "outline", size: "large" }
          );
          google.accounts.id.prompt(); 
        }
    
    const uploadformdata = document.getElementById('uploadformdata');
    uploadformdata.addEventListener('submit', async event => 
    {
      event.preventDefault();
     
      var files = document.getElementById('file').files;  
      const file = files[0];
      const form = new FormData();
      form.append('file', file);

      const response = await fetch('https://bucket.reportbase5836.workers.dev/bucket1/drop.zip', 
      {
        method: 'POST',
        headers:{'Content-Type': 'application/zip'},            
        body: form
      });

      const result = await response.text();
        console.log(result);
    });
</script>    

      <script src="https://accounts.google.com/gsi/client" async defer></script>
      <div id="g_id_onload"
         data-client_id="676848032016-7rdfc1a1gse8olfh399kfqtahqvu5ci5.apps.googleusercontent.com"
         data-ux_mode="redirect"
         data-login_uri="https://reportbase.me/login"
      </div>
      <div class="g_id_signin"
         data-type="standard"
         data-size="large"
         data-theme="outline"
         data-text="sign_in_with"
         data-shape="rectangular"
         data-logo_alignment="left">
      </div>
</body>
</html>
